%%LEX
%literals: "()\"+*"
%ignore: ' \t\n'
%tokens:
NUM: '\d+'
    t.value = int(t.value)
    return t
%error:
    print('Car치ter ilegal: ', t.value[0])
    t.lexer.skip(1)
%code:
    lexer = lex.lex()

%%YACC
%grammar:
Z -> "Sexp" {print(p[1])}

Sexp -> "'(' '+' Lista ')'" {p[0] = somatorio(p[3])}
    | "'(' '*' Lista ')'" {p[0] = produtorio(p[3])}
    | "NUM" {p[0] = p[1]}

Lista -> "Lista Sexp" {p[0] = p[1]+ [p[2]]}
    | "Sexp Sexp" {p[0] = [p[1],p[2]]}

%error:
    print('Erro sint치tico: ', p)

%code:

    def somatorio(lista):
        result = 0
        for i in lista:
            result += i
        return result

    def produtorio(lista):
        result = 1
        for i in lista:
            result *= i
        return result

    parser = yacc.yacc()


    import sys
    for linha in sys.stdin:
        parser.success = True
        parser.parse(linha)
        if parser.success:
            print("Frase v치lida: ", linha)
        else :
            print("Frase inv치lida... Corrija e tente novamente!")
